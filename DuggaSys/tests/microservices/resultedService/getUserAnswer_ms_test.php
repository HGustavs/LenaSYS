<?php

include "../../../../Shared/test.php";

$testsData = array(
    //------------------------------------------------------------------------------------------
    // This tests the microservice getUserAnswer_ms 
    //------------------------------------------------------------------------------------------
    'getUserAnswer_ms' => array(
        'expected-output' => '{"tableInfo":[{"duggaName":"Linjedugga 1","hash":"AcIj-Ld6","password":"OjOEh8R","teacher_visited":null,"submitted":"2015-05-20 10:49:22","timesSubmitted":1,"timesAccessed":1},{"duggaName":"Linjedugga 1","hash":"j-2b6WJQ","password":"8uOlUgu","teacher_visited":null,"submitted":"2015-05-20 11:18:42","timesSubmitted":2,"timesAccessed":2},{"duggaName":"Fr\u00e5gedugga 1","hash":"PWOXfmEw","password":"Ns0vg96","teacher_visited":null,"submitted":"2015-05-21 14:17:02","timesSubmitted":3,"timesAccessed":3},{"duggaName":"Transformationsdugga 1","hash":"wI8e3Lbn","password":"n6D02pM","teacher_visited":null,"submitted":"2015-05-20 14:40:35","timesSubmitted":4,"timesAccessed":4},{"duggaName":"Rapport inl\u00e4mning","hash":"Ac3YM_fc","password":"zIN6IVv","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":5,"timesAccessed":5},{"duggaName":"Rapport inl\u00e4mning","hash":"3X9PW84D","password":"lGR2hLN","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":6,"timesAccessed":6},{"duggaName":"Rapport inl\u00e4mning","hash":"PMQ_1lmO","password":"8OEUgjm","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":2,"timesAccessed":0},{"duggaName":"Rapport inl\u00e4mning","hash":"rHGRejwb","password":"H1mPcH7","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":3,"timesAccessed":1},{"duggaName":"Rapport inl\u00e4mning","hash":"1iGNG0ts","password":"EE8Z1C6","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":3,"timesAccessed":5},{"duggaName":"Rapport inl\u00e4mning","hash":"fk6O8q8O","password":"5Rau0Np","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":3,"timesAccessed":0},{"duggaName":"Rapport inl\u00e4mning","hash":"oXNRK2bE","password":"hQI907E","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":3,"timesAccessed":6},{"duggaName":"Rapport inl\u00e4mning","hash":"sTtviHYA","password":"vAOLzOY","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":2,"timesAccessed":0},{"duggaName":"Rapport inl\u00e4mning","hash":"U2m95fJX","password":"6j6JmEc","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":7,"timesAccessed":0},{"duggaName":"Rapport inl\u00e4mning","hash":"i4DbRocC","password":"SamXJ4C","teacher_visited":null,"submitted":"2015-05-20 14:50:35","timesSubmitted":3,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"E_X-FUTy","password":"yMp0cdW","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"HUQ0mMrf","password":"iRIlrbY","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":5,"timesAccessed":0},{"duggaName":"F\u00e4rgdugga 1","hash":"qayEjxM","password":"ne6FYtR","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":3,"timesAccessed":11},{"duggaName":"F\u00e4rgdugga 1","hash":"5wUDgDKA","password":"NKjeM6u","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":2},{"duggaName":"F\u00e4rgdugga 1","hash":"r9aPgMJC","password":"z3MLEli","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":3,"timesAccessed":4},{"duggaName":"F\u00e4rgdugga 1","hash":"Bg6A9ntm","password":"hJWG9ga","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":4,"timesAccessed":2},{"duggaName":"F\u00e4rgdugga 2","hash":"mOr-HtS7","password":"jQ2mBWw","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":5,"timesAccessed":2},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"_P3gX0H8","password":"0Yt8yk6","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":5,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"jaajJU2c","password":"XWnaSrc","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":23,"timesAccessed":2},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"k03BbkMW","password":"n0nYEO8","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":30,"timesAccessed":20},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"LZyCZVyl","password":"daasHge","teacher_visited":null,"submitted":"2018-05-17 09:50:56","timesSubmitted":2,"timesAccessed":3},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"i5Gx1poI","password":"pQNEOgd","teacher_visited":null,"submitted":"2018-05-17 09:50:56","timesSubmitted":3,"timesAccessed":5},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"50iDVIzI","password":"T9eeM0Z","teacher_visited":null,"submitted":"2018-05-17 09:50:56","timesSubmitted":30,"timesAccessed":0},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"ud4CDi8S","password":"PEgssrJ","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":53},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"aPD7uul1","password":"dxDsL14","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":35,"timesAccessed":2},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"BiO9n3fd","password":"nthuvyC","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":7},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"WExgDG4r","password":"IvcJ5So","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":23},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"_EPw4-aR","password":"AiDT325","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":6,"timesAccessed":3},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"rt-5amuF","password":"2NXnvnr","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":2,"timesAccessed":4},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"yk7bSIHl","password":"g1NB5nI","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":5},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"XkVYKx6g","password":"pL9GJbG","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":4,"timesAccessed":5},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"cP40SS4o","password":"gW0We3T","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":4,"timesAccessed":7},{"duggaName":"F\u00e4rgdugga 1","hash":"zrnYYQE-","password":"DOKh69W","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":3,"timesAccessed":3},{"duggaName":"F\u00e4rgdugga 1","hash":"FSvPeWIa","password":"xDZqgWE","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":5,"timesAccessed":5},{"duggaName":"F\u00e4rgdugga 1","hash":"WWmSAvwJ","password":"HQJtckt","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":3,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"GsRsvENM","password":"6LXo0ow","teacher_visited":null,"submitted":"2018-05-15 09:50:56","timesSubmitted":6,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"rlzxve-7","password":"ig3HpM0","teacher_visited":null,"submitted":"2018-05-15 09:50:56","timesSubmitted":3,"timesAccessed":3},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"Ioi7DzXO","password":"RLXmgiC","teacher_visited":null,"submitted":"2018-05-15 09:50:56","timesSubmitted":6,"timesAccessed":7},{"duggaName":"Fr\u00e5gedugga 1","hash":"veoWGKt3","password":"6x5xIUB","teacher_visited":null,"submitted":"2018-05-17 10:23:28","timesSubmitted":9,"timesAccessed":7},{"duggaName":"Fr\u00e5gedugga 1","hash":"ZIMTvMH-","password":"H9Fv5xI","teacher_visited":null,"submitted":"2018-05-17 10:23:28","timesSubmitted":3,"timesAccessed":10},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"85UX3vwC","password":"4x90nEw","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":3,"timesAccessed":3},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"ZGUZ0FRm","password":"yTHrRLE","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":3,"timesAccessed":23},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"rJeELjy7","password":"lSBhIj1","teacher_visited":null,"submitted":"2018-05-17 09:12:51","timesSubmitted":30,"timesAccessed":63},{"duggaName":"F\u00e4rgdugga 1","hash":"E4BD7Itw","password":"dixWjrp","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":63},{"duggaName":"F\u00e4rgdugga 1","hash":"fRuKjKNA","password":"EK05cvo","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":30,"timesAccessed":30},{"duggaName":"Random clipping dugga","hash":"tzcWn6fo","password":"r73oWMU","teacher_visited":null,"submitted":"2018-05-17 10:50:42","timesSubmitted":20,"timesAccessed":21},{"duggaName":"Random clipping dugga","hash":"GafQtYbr","password":"hfSytjU","teacher_visited":null,"submitted":"2018-05-17 10:50:42","timesSubmitted":62,"timesAccessed":62},{"duggaName":"F\u00e4rgdugga 1","hash":"3yYWGueu","password":"H1gnqan","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":32,"timesAccessed":32},{"duggaName":"F\u00e4rgdugga 1","hash":"C4I7zCY9","password":"ugMkvfM","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":64,"timesAccessed":53},{"duggaName":"F\u00e4rgdugga 1","hash":"_CzUVPnP","password":"e8NoaKG","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":50,"timesAccessed":50},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"zZDU3EZ4","password":"G0nSWSS","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":32,"timesAccessed":52},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"8xj6wlDP","password":"ZA8jnsT","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":5,"timesAccessed":57},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"5Q_y-XpE","password":"vqqrtO0","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":73,"timesAccessed":62},{"duggaName":"F\u00e4rgdugga 1","hash":"MVoMjyzz","password":"HhBQcE4","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":90,"timesAccessed":82},{"duggaName":"F\u00e4rgdugga 1","hash":"b7WkhPfS","password":"v08NoPL","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":44,"timesAccessed":32},{"duggaName":"F\u00e4rgdugga 1","hash":"1lt9CRZg","password":"ttGtOEY","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":30,"timesAccessed":64},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"i9LvZiTG","password":"UwlhXmw","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":21},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"2gUahmAG","password":"XcH2100","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":2},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"EIGdu6tF","password":"pU4baCA","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":64,"timesAccessed":64},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"R3g8Vb9O","password":"h7DWBMV","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":2,"timesAccessed":7},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"9F1f9crH","password":"yLZk2PH","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":1,"timesAccessed":7},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"4v6v34-y","password":"BKEOI2f","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":7,"timesAccessed":5},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"plDMwkUA","password":"CoxU6um","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":5,"timesAccessed":4},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"fItTXD-f","password":"gFOanNY","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":3},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"PWVykkqQ","password":"nlORj8c","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":3,"timesAccessed":6},{"duggaName":"F\u00e4rgdugga 1","hash":"w4kSpVTx","password":"FCkjqYK","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":4,"timesAccessed":6},{"duggaName":"F\u00e4rgdugga 1","hash":"quQLXaEH","password":"qFXWiZG","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":5,"timesAccessed":6},{"duggaName":"F\u00e4rgdugga 1","hash":"RiilHhra","password":"bhjKKUx","teacher_visited":null,"submitted":"2014-05-17 09:12:51","timesSubmitted":3,"timesAccessed":2},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"t7tZSCOq","password":"gM8tx24","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":7,"timesAccessed":7},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"VejcNiQa","password":"Htq9bVU","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":4,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"10M2GdnO","password":"8uFwiv0","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":8,"timesAccessed":8},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"KYCLxJOE","password":"xCTpfok","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":4,"timesAccessed":6},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"IR-ZI93p","password":"tYtOujJ","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":32,"timesAccessed":7},{"duggaName":"Bitr\u00e4kningsdugga 1","hash":"n4nPEAJs","password":"UWbvbEQ","teacher_visited":null,"submitted":"2015-01-15 09:12:51","timesSubmitted":1,"timesAccessed":2},{"duggaName":"Bitr\u00e4kningsdugga 2","hash":"41eaf614","password":"b506a9d3","teacher_visited":null,"submitted":"2022-05-09 09:12:51","timesSubmitted":2,"timesAccessed":9},{"duggaName":"Linjedugga 2","hash":"3a75c017","password":"b03463f7","teacher_visited":null,"submitted":"2022-05-09 10:49:22","timesSubmitted":1,"timesAccessed":1},{"duggaName":"Transformationsdugga 2","hash":"228f1f11","password":"c4253076","teacher_visited":null,"submitted":"2022-05-09 14:40:35","timesSubmitted":4,"timesAccessed":4},{"duggaName":"Random css dugga","hash":"729c7a78","password":"edcb7735","teacher_visited":null,"submitted":"2022-05-09 14:17:02","timesSubmitted":3,"timesAccessed":3},{"duggaName":"TestMoment","hash":"TestHash","password":"TestPass","teacher_visited":"2024-02-02 02:02:02","submitted":"2024-01-01 01:01:01","timesSubmitted":99999,"timesAccessed":88888}],"duggaFilterOptions":[{"entryname":"Bitr\u00e4kningsdugga 1","0":"Bitr\u00e4kningsdugga 1","kind":3,"1":3,"lid":2002,"2":2002,"moment":2001,"3":2001},{"entryname":"Bitr\u00e4kningsdugga 2","0":"Bitr\u00e4kningsdugga 2","kind":3,"1":3,"lid":2003,"2":2003,"moment":2001,"3":2001},{"entryname":"F\u00e4rgdugga 1","0":"F\u00e4rgdugga 1","kind":3,"1":3,"lid":2005,"2":2005,"moment":2004,"3":2004},{"entryname":"F\u00e4rgdugga 2","0":"F\u00e4rgdugga 2","kind":3,"1":3,"lid":2006,"2":2006,"moment":2004,"3":2004},{"entryname":"Linjedugga 1","0":"Linjedugga 1","kind":3,"1":3,"lid":2008,"2":2008,"moment":2007,"3":2007},{"entryname":"Linjedugga 2","0":"Linjedugga 2","kind":3,"1":3,"lid":2009,"2":2009,"moment":2007,"3":2007},{"entryname":"Transformationsdugga 1","0":"Transformationsdugga 1","kind":3,"1":3,"lid":2011,"2":2011,"moment":2010,"3":2010},{"entryname":"Transformationsdugga 2","0":"Transformationsdugga 2","kind":3,"1":3,"lid":2012,"2":2012,"moment":2010,"3":2010},{"entryname":"Fr\u00e5gedugga 1","0":"Fr\u00e5gedugga 1","kind":3,"1":3,"lid":2014,"2":2014,"moment":2013,"3":2013},{"entryname":"Rapport inl\u00e4mning","0":"Rapport inl\u00e4mning","kind":3,"1":3,"lid":2016,"2":2016,"moment":2015,"3":2015},{"entryname":"Random css dugga","0":"Random css dugga","kind":3,"1":3,"lid":2034,"2":2034,"moment":2033,"3":2033},{"entryname":"Random clipping dugga","0":"Random clipping dugga","kind":3,"1":3,"lid":2036,"2":2036,"moment":2035,"3":2035},{"entryname":"TestMoment","0":"TestMoment","kind":3,"1":3,"lid":4294967295,"2":4294967295,"moment":null,"3":null}]}',
        
        'query-before-test-1' => "INSERT INTO listentries (lid, vers, entryname, creator, cid, kind) VALUES (4294967295, 97732, 'TestMoment', 101, 2, 3);", 
        'query-before-test-2' => "INSERT INTO userAnswer (cid, vers, hash, password, submitted, timesSubmitted, timesAccessed, moment, last_Time_techer_visited) VALUES (2, 97732, 'TestHash', 'TestPass', '2024-01-01 01:01:01', 99999, 88888, 4294967295, '2024-02-02 02:02:02');",
        'query-after-test-1' => "DELETE FROM userAnswer WHERE hash = 'TestHash';",        
        'query-after-test-2' => "DELETE FROM listentries WHERE lid = 4294967295;",
        'service' => 'http://localhost/LenaSYS/DuggaSys/microservices/resultedService/getUserAnswer_ms.php',
        'service-data' => serialize(
            array( // Data that service needs to execute function
                'opt' => 'GET',
                'username' => 'brom',
                'password' => 'password',
                'cid' => '2',
                'vers' => '97732',
                'hash' => 'TestHash'
            )
        ),
        'filter-output' => serialize(
            array( // Filter what output to use in assert test, use none to use all ouput from service
                'tableInfo' => array(
                    'duggaName',
                    'hash',
                    'password',
                    'teacher_visited',
                    'submitted',
                    'timesSubmitted',
                    'timesAccessed'
                ),
                'duggaFilterOptions'
            )
        ),
    ),
);

testHandler($testsData, true); // 2nd argument (prettyPrint): true = prettyprint (HTML), false = raw JSON