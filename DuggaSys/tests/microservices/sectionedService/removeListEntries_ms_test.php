<?php
include_once "../../../../Shared/test.php";

$testsData = array(
    'removeListEntries_ms' => array(
        'expected-output' => '{"entries":[{"entryname":"Tillg\u00e4ngliga Duggor","lid":3001,"pos":0,"kind":4,"moment":3001,"link":"","handindeadline":null,"visible":1,"highscoremode":0,"gradesys":2,"code_id":null,"deadline":null,"relativedeadline":null,"qrelease":null,"comments":null,"qstart":null,"grptype":null,"tabs":2,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"3D Dugga","lid":3002,"pos":1,"kind":3,"moment":3001,"link":"13","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"BIT Dugga","lid":3003,"pos":2,"kind":3,"moment":3001,"link":"14","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Boxmodell","lid":3004,"pos":3,"kind":3,"moment":3001,"link":"15","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Clipping Maskin Dugga","lid":3005,"pos":4,"kind":3,"moment":3001,"link":"16","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Color Dugga","lid":3006,"pos":5,"kind":3,"moment":3001,"link":"17","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Contribution","lid":3007,"pos":6,"kind":3,"moment":3001,"link":"18","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Curve Dugga","lid":3008,"pos":7,"kind":3,"moment":3001,"link":"19","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Daily Minutes","lid":3009,"pos":8,"kind":3,"moment":3001,"link":"20","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Diagram Dugga","lid":3010,"pos":9,"kind":3,"moment":3001,"link":"21","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Dugga 1","lid":3011,"pos":10,"kind":3,"moment":3001,"link":"22","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Dugga 2","lid":3012,"pos":11,"kind":3,"moment":3001,"link":"23","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Dugga 3","lid":3013,"pos":12,"kind":3,"moment":3001,"link":"24","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Dugga 4","lid":3014,"pos":13,"kind":3,"moment":3001,"link":"25","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Dugga 5","lid":3015,"pos":14,"kind":3,"moment":3001,"link":"26","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Dugga 6","lid":3016,"pos":15,"kind":3,"moment":3001,"link":"27","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Feedback Dugga","lid":3017,"pos":16,"kind":3,"moment":3001,"link":"28","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Generic Dugga File Receive","lid":3018,"pos":17,"kind":3,"moment":3001,"link":"29","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Group Assignment","lid":3019,"pos":18,"kind":3,"moment":3001,"link":"30","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"HTML CSS Dugga","lid":3020,"pos":19,"kind":3,"moment":3001,"link":"31","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"HTML CSS Dugga Light","lid":3021,"pos":20,"kind":3,"moment":3001,"link":"32","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Kryss","lid":3022,"pos":21,"kind":3,"moment":3001,"link":"33","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Placeholder Dugga","lid":3023,"pos":22,"kind":3,"moment":3001,"link":"34","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Shapes Dugga","lid":3024,"pos":23,"kind":3,"moment":3001,"link":"35","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Transforms Dugga","lid":3025,"pos":24,"kind":3,"moment":3001,"link":"36","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"XMLAPI Report","lid":3026,"pos":25,"kind":3,"moment":3001,"link":"37","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"Seminar Dugga","lid":3027,"pos":25,"kind":3,"moment":3001,"link":"38","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"},{"entryname":"SVG Dugga","lid":3028,"pos":27,"kind":3,"moment":3001,"link":"39","handindeadline":null,"visible":1,"highscoremode":1,"gradesys":0,"code_id":null,"deadline":"2020-06-30 00:00:00","relativedeadline":null,"qrelease":"2020-05-01 00:00:00","comments":null,"qstart":null,"grptype":null,"tabs":0,"feedbackenabled":0,"feedbackquestion":null,"ts":"2024-05-13 13:41:30"}],"debug":"NONE!","writeaccess":true,"studentteacher":false,"readaccess":true,"coursename":"Demo-Course","coursevers":"52432","coursecode":"G420","courseid":"1894","links":[{"fileid":-1,"filename":"---===######===---"},{"fileid":45,"filename":"diagram.json"},{"fileid":47,"filename":"helloWorld.html"},{"fileid":4,"filename":"HTML_Ex1.txt"},{"fileid":6,"filename":"HTML_Ex2.txt"},{"fileid":8,"filename":"HTML_Ex3.txt"},{"fileid":10,"filename":"HTML_Ex4.txt"},{"fileid":12,"filename":"HTML_Ex5.txt"},{"fileid":14,"filename":"HTML_Ex6.txt"},{"fileid":16,"filename":"HTML_Ex7.txt"},{"fileid":20,"filename":"HTML_Ex8.txt"},{"fileid":23,"filename":"JavaScript_Ex1.txt"},{"fileid":26,"filename":"JavaScript_Ex2.txt"},{"fileid":29,"filename":"JavaScript_Ex3.txt"},{"fileid":50,"filename":"mdTest.md"},{"fileid":31,"filename":"PHP_Ex1.txt"},{"fileid":33,"filename":"PHP_Ex2.txt"},{"fileid":35,"filename":"PHP_Ex3.txt"},{"fileid":38,"filename":"Shader_Ex1.txt"},{"fileid":41,"filename":"Shader_Ex2.txt"}],"duggor":[{"id":13,"qname":"3D Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":14,"qname":"BIT Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":15,"qname":"Boxmodell","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":16,"qname":"Clipping Maskin Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":17,"qname":"Color Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":18,"qname":"Contribution","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":19,"qname":"Curve Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":20,"qname":"Daily Minutes","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":21,"qname":"Diagram Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":22,"qname":"Dugga 1","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":23,"qname":"Dugga 2","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":24,"qname":"Dugga 3","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":25,"qname":"Dugga 4","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":26,"qname":"Dugga 5","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":27,"qname":"Dugga 6","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":28,"qname":"Feedback Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":29,"qname":"Generic Dugga File Receive","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":30,"qname":"Group Assignment","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":31,"qname":"HTML CSS Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":32,"qname":"HTML CSS Dugga Light","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":33,"qname":"Kryss","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":34,"qname":"Placeholder Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":38,"qname":"Seminar Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":35,"qname":"Shapes Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":39,"qname":"SVG Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":36,"qname":"Transforms Dugga","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null},{"id":37,"qname":"XMLAPI Report","release":"2020-05-01 00:00:00","deadline":"2020-06-30 00:00:00","relativedeadline":null}],"results":[],"versions":[{"cid":1,"coursecode":"DV12G","vers":"45656","versname":"HT15","coursename":"Webbprogrammering","coursenamealt":"UNK","startdate":"2014-12-29 00:00:00","enddate":"2015-03-08 00:00:00","motd":"Webbprogrammering - HT15"},{"cid":1,"coursecode":"DV12G","vers":"45657","versname":"HT16","coursename":"Webbprogrammering","coursenamealt":"UNK","startdate":"2015-12-29 00:00:00","enddate":"2016-03-08 00:00:00","motd":"Webbprogrammering - HT16"},{"cid":2,"coursecode":"IT118G","vers":"97731","versname":"HT14","coursename":"Webbutveckling - datorgrafik","coursenamealt":"UNK","startdate":"2014-12-29 00:00:00","enddate":"2015-03-08 00:00:00","motd":"Webbutveckling - datorgrafik - HT14"},{"cid":2,"coursecode":"IT118G","vers":"97732","versname":"HT15","coursename":"Webbutveckling - datorgrafik","coursenamealt":"UNK","startdate":"2014-12-29 00:00:00","enddate":"2015-03-08 00:00:00","motd":"Webbutveckling - datorgrafik - HT15"},{"cid":3,"coursecode":"IT500G","vers":"1337","versname":"HT15","coursename":"Datorns grunder","coursenamealt":"UNK","startdate":"2014-12-29 00:00:00","enddate":"2015-03-08 00:00:00","motd":"Datorns grunder - HT15"},{"cid":4,"coursecode":"IT301G","vers":"1338","versname":"HT15","coursename":"Software Engineering","coursenamealt":"UNK","startdate":"2014-12-29 00:00:00","enddate":"2015-03-08 00:00:00","motd":"Software Engineering - HT15"},{"cid":305,"coursecode":"IT308G","vers":"12305","versname":"HT15","coursename":"Objektorienterad programmering","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":307,"coursecode":"IT115G","vers":"12307","versname":"HT15","coursename":"Datorns grunder","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":308,"coursecode":"MA161G","vers":"12308","versname":"HT15","coursename":"Diskret matematik","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":309,"coursecode":"DA322G","vers":"12309","versname":"HT15","coursename":"Operativsystem","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":312,"coursecode":"IT326G","vers":"12312","versname":"HT15","coursename":"Distribuerade system","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":319,"coursecode":"DV736A","vers":"12319","versname":"HT15","coursename":"Examensarbete i datavetenskap","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":324,"coursecode":"IT108G","vers":"12324","versname":"HT15","coursename":"Webbutveckling - webbplatsdesign","coursenamealt":"UNK","startdate":null,"enddate":null,"motd":null},{"cid":1885,"coursecode":"G1337","vers":"1337","versname":"","coursename":"Testing-Course","coursenamealt":"Course for testing codeviewer","startdate":"2020-05-01 00:00:00","enddate":"2020-06-30 00:00:00","motd":"Code examples shows both templateid and boxid!"},{"cid":1894,"coursecode":"G420","vers":"52432","versname":"ST20","coursename":"Demo-Course","coursenamealt":"Chaos Theory - Conspiracy 64k Demo","startdate":"2020-05-01 00:00:00","enddate":"2020-06-30 00:00:00","motd":"Demo Course 2020 - All current duggas"}],"codeexamples":[{"exampleid":"-1","cid":"","examplename":"","sectionname":"New Example","runlink":"","cversion":""}],"unmarked":2,"startdate":"2020-05-01 00:00:00","enddate":"2020-06-30 00:00:00","groups":{"No":["1","2","3","4","5","6","7","8"],"Le":["A","B","C","D","E","F","G","H"],"Vi":["I","II","III","IV","V","VI","VII","VIII"]},"grpmembershp":"UNK","grplst":[],"userfeedback":[],"feedbackquestion":"UNK","avgfeedbackscore":0}',
      

        'query-before-test-1' => 'DELETE FROM useranswer WHERE moment IN (3001, 3002);
                          DELETE FROM listentries WHERE lid IN (3001, 3002); 
                          INSERT INTO listentries (lid, entryname, pos, visible) VALUES 
                          (3001, "Tillgängliga Duggor", 0, 1), 
                          (3002, "3D Dugga", 1, 1);',
        'query-after-test-1' => 'DELETE FROM listentries WHERE lid IN (3001, 3002);',
        'service' => 'http://localhost/LenaSYS/DuggaSys/microservices/sectionedService/removeListEntries_ms.php',
        'service-data' => serialize(
            array( 
                'username' => 'brom',
                'password' => 'password',
                'courseid'	 =>'1894',
                'coursename' =>	'1894',
                'coursevers'	 =>'52432',
                'comment' =>	'undefined',
                'opt' =>	'DELETE',
              'lid'	 =>'3001',
              'log_uuid' =>	'Or4ZB0gc8A4fjLH',
              'hash' =>	'UNK'

            )
        ),
        'filter-output' => serialize(
            array( 
                'none'
            )
        ),
    )
);

testHandler($testsData, true); // 2nd argument (prettyPrint): true = prettyprint (HTML), false = raw JSON